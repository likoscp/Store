<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/style.css">
    <title>Main Page</title>
</head>

<body>
    <div class="container">
        <h1>API</h1>
        <div class="button-group">
            <h3>Messages</h3>
            <button onclick="sendRequest('/Messages', 'GET')">Get All Messages</button>
            <button onclick="sendRequest('/Messages', 'POST')">Create Message</button>
            <button onclick="sendRequest('/Messages/:id', 'GET')">Get Message by ID</button>
            <button onclick="sendRequest('/Messages/:id', 'PUT')">Update Message</button>
            <button onclick="sendRequest('/Messages/:id', 'DELETE')">Delete Message</button>
        </div>

        <div class="button-group">
            <h3>Orders</h3>
            <button onclick="sendRequest('/Orders', 'GET')">Get All Orders</button>
            <button onclick="sendRequest('/Orders', 'POST')">Create Order</button>
            <button onclick="sendRequest('/Orders/:id', 'GET')">Get Order by ID</button>
            <button onclick="sendRequest('/Orders/:id', 'PUT')">Update Order</button>
            <button onclick="sendRequest('/Orders/:id', 'DELETE')">Delete Order</button>
        </div>

        <div class="button-group">
            <h3>Users</h3>
            <button onclick="sendRequest('/Users', 'GET')">Get All Users</button>
            <button onclick="sendRequest('/Users', 'POST')">Create User</button>
            <button onclick="sendRequest('/Users/:id', 'GET')">Get User by ID</button>
            <button onclick="sendRequest('/Users/:id', 'PUT')">Update User</button>
            <button onclick="sendRequest('/Users/:id', 'DELETE')">Delete User</button>
        </div>

        <div class="button-group">
            <h3>Posts</h3>
            <button onclick="sendRequest('/Posts', 'GET')">Get All Posts</button>
            <button onclick="sendRequest('/Posts', 'POST')">Create Post</button>
            <button onclick="sendRequest('/Posts/:id', 'GET')">Get Post by ID</button>
            <button onclick="sendRequest('/Posts/:id', 'PUT')">Update Post</button>
            <button onclick="sendRequest('/Posts/:id', 'DELETE')">Delete Order</button>
        </div>

        <div class="button-group">
            <h3>Tickets</h3>
            <button onclick="sendRequest('/Tickets', 'GET')">Get All Tickets</button>
            <button onclick="sendRequest('/Tickets', 'POST')">Create Ticket</button>
            <button onclick="sendRequest('/Tickets/:id', 'GET')">Get Ticket by ID</button>
            <button onclick="sendRequest('/Tickets/:id', 'PUT')">Update Ticket</button>
            <button onclick="sendRequest('/Tickets/:id', 'DELETE')">Delete Order</button>
        </div>

        <div class="button-group">
            <h3>Products</h3>
            <button onclick="sendRequest('/Products', 'GET')">Get All Products</button>
            <button onclick="sendRequest('/Products', 'POST')">Create Product</button>
            <button onclick="sendRequest('/Products/:id', 'GET')">Get Product by ID</button>
            <button onclick="sendRequest('/Products/:id', 'PUT')">Update Product</button>
            <button onclick="sendRequest('/Products/:id', 'DELETE')">Delete Order</button>
        </div>

        <div id="results" class="results"></div>
        <div id="pagination" class="pagination"></div>

    </div>

    <script>
    let currentPage = 1;
        const limit = 10; 
        
        async function sendRequest(endpoint, method, page = 1) {
            event.preventDefault(); 
            const id = prompt("Enter ID if required (leave blank for none):");
            let url = id ? endpoint.replace(':id', id) : endpoint;
            if (method === 'GET') {
                const queryParams = new URLSearchParams({ page, limit }).toString();
                url += `?${queryParams}`;
            }
            let body = null;
            if (method === 'POST' || method === 'PUT') {
                const data = prompt("Enter JSON data for request body:");
                body = JSON.parse(data || "{}");
            }
        
            try {
                const token = localStorage.getItem('token');
                const response = await fetch(url, {
                    method,
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: body ? JSON.stringify(body) : null,
                });
        
                const result = await response.json();
                
                document.getElementById('results').textContent = JSON.stringify(result.data || result, null, 2);
        
                if (result.totalPages) {
                    showPagination(endpoint, method, result.totalPages);
                }
            } catch (error) {
                document.getElementById('results').textContent = `Error: ${error.message}`;
            }
        }
        
        function showPagination(endpoint, method, totalPages) {
            const paginationContainer = document.getElementById('pagination');
            paginationContainer.innerHTML = `
                <button onclick="changePage('${endpoint}', '${method}', -1)" ${currentPage === 1 ? 'disabled' : ''}>Previous</button>
                <span>Page ${currentPage} of ${totalPages}</span>
                <button onclick="changePage('${endpoint}', '${method}', 1)" ${currentPage >= totalPages ? 'disabled' : ''}>Next</button>
            `;
        }
        
        function changePage(endpoint, method, direction) {
            currentPage += direction;
            if (currentPage < 1) currentPage = 1;
            sendRequest(endpoint, method, currentPage);
        }
        
    </script>
</body>

</html>